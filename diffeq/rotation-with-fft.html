<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Maths with Julia – rotation-with-fft</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../diffeq/gpu.html" rel="next">
<link href="../diffeq/poisson-equation.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Maths with Julia</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pnavaro/math-julia" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../diffeq/runge-kutta.html">Differential equations</a></li><li class="breadcrumb-item"><a href="../diffeq/rotation-with-fft.html">Rotation using FFT</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Performance</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/put-code-inside-function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Put code inside functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/pay-attention-to-memory-allocation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Memory allocation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/when-avoid-abstract-type.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract type</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/write-type-stable-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Type stability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/access-arrays-in-memory-order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Memory order</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/vectorized-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vectorized operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/consider-static-arrays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">StaticArrays.jl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/good-practices-for-io.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Good practices for I/O</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../performance/performance-annotations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance annotations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Differential equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diffeq/runge-kutta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Runge-Kutta methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diffeq/poisson-equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson Equation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diffeq/rotation-with-fft.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Rotation using FFT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diffeq/gpu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GPU</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Package</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#julia-type-for-mesh-information" id="toc-julia-type-for-mesh-information" class="nav-link active" data-scroll-target="#julia-type-for-mesh-information">Julia type for mesh information</a></li>
  <li><a href="#initialization-of-f-2d-array-of-double-float" id="toc-initialization-of-f-2d-array-of-double-float" class="nav-link" data-scroll-target="#initialization-of-f-2d-array-of-double-float">Initialization of f : 2d array of double float</a>
  <ul class="collapse">
  <li><a href="#julia-function-to-compute-exact-solution" id="toc-julia-function-to-compute-exact-solution" class="nav-link" data-scroll-target="#julia-function-to-compute-exact-solution">Julia function to compute exact solution</a></li>
  <li><a href="#create-the-gif-to-show-what-we-are-computing" id="toc-create-the-gif-to-show-what-we-are-computing" class="nav-link" data-scroll-target="#create-the-gif-to-show-what-we-are-computing">Create the gif to show what we are computing</a></li>
  <li><a href="#function-to-compute-error" id="toc-function-to-compute-error" class="nav-link" data-scroll-target="#function-to-compute-error">Function to compute error</a></li>
  <li><a href="#naive-translation-of-a-matlab-code" id="toc-naive-translation-of-a-matlab-code" class="nav-link" data-scroll-target="#naive-translation-of-a-matlab-code">Naive translation of a matlab code</a>
  <ul class="collapse">
  <li><a href="#vectorized-version" id="toc-vectorized-version" class="nav-link" data-scroll-target="#vectorized-version">Vectorized version</a></li>
  </ul></li>
  <li><a href="#inplace-computation" id="toc-inplace-computation" class="nav-link" data-scroll-target="#inplace-computation">Inplace computation</a>
  <ul class="collapse">
  <li><a href="#use-plans-for-fft" id="toc-use-plans-for-fft" class="nav-link" data-scroll-target="#use-plans-for-fft">Use plans for fft</a></li>
  </ul></li>
  <li><a href="#inplace-computation-and-fft-plans" id="toc-inplace-computation-and-fft-plans" class="nav-link" data-scroll-target="#inplace-computation-and-fft-plans">Inplace computation and fft plans</a></li>
  <li><a href="#explicit-transpose-of-f" id="toc-explicit-transpose-of-f" class="nav-link" data-scroll-target="#explicit-transpose-of-f">Explicit transpose of <code>f</code></a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/pnavaro/math-julia/blob/master/diffeq/rotation-with-fft.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Rotation using FFT</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><span class="math display">\[
\frac{d f}{dt} +  (v \frac{d f}{dx} - x \frac{d f}{dv}) = 0
\]</span></p>
<p><span class="math display">\[
x \in [-\pi, \pi],\qquad y \in [-\pi, \pi] \qquad \mbox{ and } \qquad t \in [0, 200\pi]
\]</span></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BenchmarkTools</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">FFTW</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="julia-type-for-mesh-information" class="level2">
<h2 class="anchored" data-anchor-id="julia-type-for-mesh-information">Julia type for mesh information</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode jl code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> OneDMesh</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    xmin <span class="op">::</span><span class="dt"> Float64</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    xmax <span class="op">::</span><span class="dt"> Float64</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    nx   <span class="op">::</span><span class="dt"> Int</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">OneDMesh</span>( <span class="op">-</span><span class="cn">π</span>, <span class="cn">π</span>, <span class="fl">128</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> TwoDMesh</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    nx   <span class="op">::</span><span class="dt"> Int</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    ny   <span class="op">::</span><span class="dt"> Int</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    xmin <span class="op">::</span><span class="dt"> Float64</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    xmax <span class="op">::</span><span class="dt"> Float64</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    ymin <span class="op">::</span><span class="dt"> Float64</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    ymax <span class="op">::</span><span class="dt"> Float64</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    dx   <span class="op">::</span><span class="dt"> Float64</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    dy   <span class="op">::</span><span class="dt"> Float64</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    x    <span class="op">::</span><span class="dt"> Vector{Float64}</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    y    <span class="op">::</span><span class="dt"> Vector{Float64}</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">TwoDMesh</span>( xmin, xmax, nx, ymin, ymax, ny)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        dx, dy <span class="op">=</span> (xmax<span class="op">-</span>xmin)<span class="op">/</span>nx, (ymax<span class="op">-</span>ymin)<span class="op">/</span>ny</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="fu">LinRange</span>(xmin, xmax, nx<span class="op">+</span><span class="fl">1</span>)[<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span>]  <span class="co"># we remove the end point</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="fu">LinRange</span>(ymin, ymax, ny<span class="op">+</span><span class="fl">1</span>)[<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span>]  <span class="co"># for periodic boundary condition</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">new</span>( nx, ny, xmin, xmax, ymin, ymax, dx, dy, x, y)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mesh <span class="op">=</span> <span class="fu">TwoDMesh</span>(<span class="op">-</span><span class="cn">π</span>, <span class="cn">π</span>, <span class="fl">128</span>, <span class="op">-</span><span class="cn">π</span>, <span class="cn">π</span>, <span class="fl">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>TwoDMesh(128, 256, -3.141592653589793, 3.141592653589793, -3.141592653589793, 3.141592653589793, 0.04908738521234052, 0.02454369260617026, [-3.141592653589793, -3.0925052683774523, -3.043417883165112, -2.9943304979527716, -2.9452431127404313, -2.89615572752809, -2.84706834231575, -2.7979809571034093, -2.748893571891069, -2.699806186678728  …  2.650718801466388, 2.6998061866787286, 2.748893571891069, 2.7979809571034098, 2.8470683423157497, 2.8961557275280905, 2.9452431127404317, 2.9943304979527716, 3.0434178831651124, 3.0925052683774528], [-3.141592653589793, -3.117048960983623, -3.0925052683774528, -3.0679615757712826, -3.0434178831651124, -3.0188741905589414, -2.994330497952771, -2.969786805346601, -2.945243112740431, -2.9206994201342606  …  2.8961557275280905, 2.9206994201342606, 2.945243112740431, 2.969786805346601, 2.994330497952771, 3.0188741905589414, 3.0434178831651124, 3.0679615757712826, 3.0925052683774528, 3.117048960983623])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> mesh.xmin, mesh.xmax, mesh.nx, mesh.dx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(mesh.xmin, mesh.xmax, mesh.nx, mesh.dx) = (-3.141592653589793, 3.141592653589793, 128, 0.04908738521234052)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(-3.141592653589793, 3.141592653589793, 128, 0.04908738521234052)</code></pre>
</div>
</div>
</section>
<section id="initialization-of-f-2d-array-of-double-float" class="level1">
<h1>Initialization of f : 2d array of double float</h1>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">Float64</span>,(mesh.nx,mesh.ny))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, x) <span class="kw">in</span> <span class="fu">enumerate</span>(mesh.x), (j, y) <span class="kw">in</span> <span class="fu">enumerate</span>(mesh.y)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    f[i,j] <span class="op">=</span> <span class="fu">exp</span>(<span class="fu">-</span>(x<span class="op">-</span><span class="fl">1</span>)<span class="fu">*</span>(x<span class="op">-</span><span class="fl">1</span>)<span class="op">/</span><span class="fl">0.1</span>)<span class="fu">*exp</span>(<span class="fu">-</span>(y<span class="op">-</span><span class="fl">1</span>)<span class="fu">*</span>(y<span class="op">-</span><span class="fl">1</span>)<span class="op">/</span><span class="fl">0.1</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="julia-function-to-compute-exact-solution" class="level3">
<h3 class="anchored" data-anchor-id="julia-function-to-compute-exact-solution">Julia function to compute exact solution</h3>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">compute_exact_solution</span>(final_time, mesh)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">Float64</span>,(mesh.nx, mesh.ny))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i, x) <span class="kw">in</span> <span class="fu">enumerate</span>(mesh.x), (j, y) <span class="kw">in</span> <span class="fu">enumerate</span>(mesh.y)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        xn <span class="op">=</span> <span class="fu">cos</span>(final_time)<span class="op">*</span>x <span class="op">-</span> <span class="fu">sin</span>(final_time)<span class="op">*</span>y</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        yn <span class="op">=</span> <span class="fu">sin</span>(final_time)<span class="op">*</span>x <span class="op">+</span> <span class="fu">cos</span>(final_time)<span class="op">*</span>y</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        f[i,j] <span class="op">=</span> <span class="fu">exp</span>(<span class="fu">-</span>(xn<span class="op">-</span><span class="fl">1</span>)<span class="fu">*</span>(xn<span class="op">-</span><span class="fl">1</span>)<span class="op">/</span><span class="fl">0.1</span>)<span class="fu">*exp</span>(<span class="fu">-</span>(yn<span class="op">-</span><span class="fl">1</span>)<span class="fu">*</span>(yn<span class="op">-</span><span class="fl">1</span>)<span class="op">/</span><span class="fl">0.1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    f</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>compute_exact_solution (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fu">compute_exact_solution</span>(<span class="fl">0.0</span>, mesh)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip930">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip930)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip931">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip930)" d="M172.001 1800.78 L2371.96 1800.78 L2371.96 47.2441 L172.001 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip932">
    <rect x="172" y="47" width="2201" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="594.738,1800.78 594.738,47.2441 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1026.1,1800.78 1026.1,47.2441 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1457.46,1800.78 1457.46,47.2441 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1888.83,1800.78 1888.83,47.2441 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2320.19,1800.78 2320.19,47.2441 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="172.001,1800.78 2371.96,1800.78 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="594.738,1800.78 594.738,1781.88 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1026.1,1800.78 1026.1,1781.88 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1457.46,1800.78 1457.46,1781.88 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1888.83,1800.78 1888.83,1781.88 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2320.19,1800.78 2320.19,1781.88 "></polyline>
<path clip-path="url(#clip930)" d="M569.437 1830.92 L587.793 1830.92 L587.793 1834.86 L573.719 1834.86 L573.719 1843.33 Q574.738 1842.98 575.756 1842.82 Q576.775 1842.64 577.793 1842.64 Q583.58 1842.64 586.96 1845.81 Q590.34 1848.98 590.34 1854.4 Q590.34 1859.97 586.867 1863.08 Q583.395 1866.15 577.076 1866.15 Q574.9 1866.15 572.631 1865.78 Q570.386 1865.41 567.979 1864.67 L567.979 1859.97 Q570.062 1861.11 572.284 1861.66 Q574.506 1862.22 576.983 1862.22 Q580.988 1862.22 583.326 1860.11 Q585.664 1858.01 585.664 1854.4 Q585.664 1850.78 583.326 1848.68 Q580.988 1846.57 576.983 1846.57 Q575.108 1846.57 573.233 1846.99 Q571.381 1847.4 569.437 1848.28 L569.437 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M609.552 1834 Q605.941 1834 604.113 1837.57 Q602.307 1841.11 602.307 1848.24 Q602.307 1855.34 604.113 1858.91 Q605.941 1862.45 609.552 1862.45 Q613.187 1862.45 614.992 1858.91 Q616.821 1855.34 616.821 1848.24 Q616.821 1841.11 614.992 1837.57 Q613.187 1834 609.552 1834 M609.552 1830.3 Q615.363 1830.3 618.418 1834.9 Q621.497 1839.49 621.497 1848.24 Q621.497 1856.96 618.418 1861.57 Q615.363 1866.15 609.552 1866.15 Q603.742 1866.15 600.664 1861.57 Q597.608 1856.96 597.608 1848.24 Q597.608 1839.49 600.664 1834.9 Q603.742 1830.3 609.552 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M985.708 1861.55 L993.347 1861.55 L993.347 1835.18 L985.037 1836.85 L985.037 1832.59 L993.301 1830.92 L997.976 1830.92 L997.976 1861.55 L1005.62 1861.55 L1005.62 1865.48 L985.708 1865.48 L985.708 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M1025.06 1834 Q1021.45 1834 1019.62 1837.57 Q1017.81 1841.11 1017.81 1848.24 Q1017.81 1855.34 1019.62 1858.91 Q1021.45 1862.45 1025.06 1862.45 Q1028.69 1862.45 1030.5 1858.91 Q1032.33 1855.34 1032.33 1848.24 Q1032.33 1841.11 1030.5 1837.57 Q1028.69 1834 1025.06 1834 M1025.06 1830.3 Q1030.87 1830.3 1033.93 1834.9 Q1037 1839.49 1037 1848.24 Q1037 1856.96 1033.93 1861.57 Q1030.87 1866.15 1025.06 1866.15 Q1019.25 1866.15 1016.17 1861.57 Q1013.12 1856.96 1013.12 1848.24 Q1013.12 1839.49 1016.17 1834.9 Q1019.25 1830.3 1025.06 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M1055.22 1834 Q1051.61 1834 1049.78 1837.57 Q1047.98 1841.11 1047.98 1848.24 Q1047.98 1855.34 1049.78 1858.91 Q1051.61 1862.45 1055.22 1862.45 Q1058.86 1862.45 1060.66 1858.91 Q1062.49 1855.34 1062.49 1848.24 Q1062.49 1841.11 1060.66 1837.57 Q1058.86 1834 1055.22 1834 M1055.22 1830.3 Q1061.03 1830.3 1064.09 1834.9 Q1067.17 1839.49 1067.17 1848.24 Q1067.17 1856.96 1064.09 1861.57 Q1061.03 1866.15 1055.22 1866.15 Q1049.41 1866.15 1046.33 1861.57 Q1043.28 1856.96 1043.28 1848.24 Q1043.28 1839.49 1046.33 1834.9 Q1049.41 1830.3 1055.22 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M1417.07 1861.55 L1424.71 1861.55 L1424.71 1835.18 L1416.4 1836.85 L1416.4 1832.59 L1424.66 1830.92 L1429.34 1830.92 L1429.34 1861.55 L1436.98 1861.55 L1436.98 1865.48 L1417.07 1865.48 L1417.07 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M1446.47 1830.92 L1464.83 1830.92 L1464.83 1834.86 L1450.75 1834.86 L1450.75 1843.33 Q1451.77 1842.98 1452.79 1842.82 Q1453.81 1842.64 1454.83 1842.64 Q1460.61 1842.64 1463.99 1845.81 Q1467.37 1848.98 1467.37 1854.4 Q1467.37 1859.97 1463.9 1863.08 Q1460.43 1866.15 1454.11 1866.15 Q1451.93 1866.15 1449.66 1865.78 Q1447.42 1865.41 1445.01 1864.67 L1445.01 1859.97 Q1447.09 1861.11 1449.32 1861.66 Q1451.54 1862.22 1454.02 1862.22 Q1458.02 1862.22 1460.36 1860.11 Q1462.7 1858.01 1462.7 1854.4 Q1462.7 1850.78 1460.36 1848.68 Q1458.02 1846.57 1454.02 1846.57 Q1452.14 1846.57 1450.27 1846.99 Q1448.41 1847.4 1446.47 1848.28 L1446.47 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M1486.59 1834 Q1482.97 1834 1481.15 1837.57 Q1479.34 1841.11 1479.34 1848.24 Q1479.34 1855.34 1481.15 1858.91 Q1482.97 1862.45 1486.59 1862.45 Q1490.22 1862.45 1492.02 1858.91 Q1493.85 1855.34 1493.85 1848.24 Q1493.85 1841.11 1492.02 1837.57 Q1490.22 1834 1486.59 1834 M1486.59 1830.3 Q1492.4 1830.3 1495.45 1834.9 Q1498.53 1839.49 1498.53 1848.24 Q1498.53 1856.96 1495.45 1861.57 Q1492.4 1866.15 1486.59 1866.15 Q1480.78 1866.15 1477.7 1861.57 Q1474.64 1856.96 1474.64 1848.24 Q1474.64 1839.49 1477.7 1834.9 Q1480.78 1830.3 1486.59 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M1852.52 1861.55 L1868.84 1861.55 L1868.84 1865.48 L1846.9 1865.48 L1846.9 1861.55 Q1849.56 1858.79 1854.14 1854.16 Q1858.75 1849.51 1859.93 1848.17 Q1862.17 1845.65 1863.05 1843.91 Q1863.96 1842.15 1863.96 1840.46 Q1863.96 1837.71 1862.01 1835.97 Q1860.09 1834.23 1856.99 1834.23 Q1854.79 1834.23 1852.34 1835 Q1849.91 1835.76 1847.13 1837.31 L1847.13 1832.59 Q1849.95 1831.46 1852.41 1830.88 Q1854.86 1830.3 1856.9 1830.3 Q1862.27 1830.3 1865.46 1832.98 Q1868.66 1835.67 1868.66 1840.16 Q1868.66 1842.29 1867.84 1844.21 Q1867.06 1846.11 1864.95 1848.7 Q1864.37 1849.37 1861.27 1852.59 Q1858.17 1855.78 1852.52 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M1888.66 1834 Q1885.04 1834 1883.22 1837.57 Q1881.41 1841.11 1881.41 1848.24 Q1881.41 1855.34 1883.22 1858.91 Q1885.04 1862.45 1888.66 1862.45 Q1892.29 1862.45 1894.09 1858.91 Q1895.92 1855.34 1895.92 1848.24 Q1895.92 1841.11 1894.09 1837.57 Q1892.29 1834 1888.66 1834 M1888.66 1830.3 Q1894.47 1830.3 1897.52 1834.9 Q1900.6 1839.49 1900.6 1848.24 Q1900.6 1856.96 1897.52 1861.57 Q1894.47 1866.15 1888.66 1866.15 Q1882.84 1866.15 1879.77 1861.57 Q1876.71 1856.96 1876.71 1848.24 Q1876.71 1839.49 1879.77 1834.9 Q1882.84 1830.3 1888.66 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M1918.82 1834 Q1915.21 1834 1913.38 1837.57 Q1911.57 1841.11 1911.57 1848.24 Q1911.57 1855.34 1913.38 1858.91 Q1915.21 1862.45 1918.82 1862.45 Q1922.45 1862.45 1924.26 1858.91 Q1926.09 1855.34 1926.09 1848.24 Q1926.09 1841.11 1924.26 1837.57 Q1922.45 1834 1918.82 1834 M1918.82 1830.3 Q1924.63 1830.3 1927.68 1834.9 Q1930.76 1839.49 1930.76 1848.24 Q1930.76 1856.96 1927.68 1861.57 Q1924.63 1866.15 1918.82 1866.15 Q1913.01 1866.15 1909.93 1861.57 Q1906.87 1856.96 1906.87 1848.24 Q1906.87 1839.49 1909.93 1834.9 Q1913.01 1830.3 1918.82 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2283.88 1861.55 L2300.2 1861.55 L2300.2 1865.48 L2278.26 1865.48 L2278.26 1861.55 Q2280.92 1858.79 2285.5 1854.16 Q2290.11 1849.51 2291.29 1848.17 Q2293.54 1845.65 2294.42 1843.91 Q2295.32 1842.15 2295.32 1840.46 Q2295.32 1837.71 2293.38 1835.97 Q2291.45 1834.23 2288.35 1834.23 Q2286.15 1834.23 2283.7 1835 Q2281.27 1835.76 2278.49 1837.31 L2278.49 1832.59 Q2281.32 1831.46 2283.77 1830.88 Q2286.22 1830.3 2288.26 1830.3 Q2293.63 1830.3 2296.82 1832.98 Q2300.02 1835.67 2300.02 1840.16 Q2300.02 1842.29 2299.21 1844.21 Q2298.42 1846.11 2296.32 1848.7 Q2295.74 1849.37 2292.63 1852.59 Q2289.53 1855.78 2283.88 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2310.07 1830.92 L2328.42 1830.92 L2328.42 1834.86 L2314.35 1834.86 L2314.35 1843.33 Q2315.37 1842.98 2316.38 1842.82 Q2317.4 1842.64 2318.42 1842.64 Q2324.21 1842.64 2327.59 1845.81 Q2330.97 1848.98 2330.97 1854.4 Q2330.97 1859.97 2327.5 1863.08 Q2324.02 1866.15 2317.7 1866.15 Q2315.53 1866.15 2313.26 1865.78 Q2311.01 1865.41 2308.61 1864.67 L2308.61 1859.97 Q2310.69 1861.11 2312.91 1861.66 Q2315.13 1862.22 2317.61 1862.22 Q2321.62 1862.22 2323.95 1860.11 Q2326.29 1858.01 2326.29 1854.4 Q2326.29 1850.78 2323.95 1848.68 Q2321.62 1846.57 2317.61 1846.57 Q2315.74 1846.57 2313.86 1846.99 Q2312.01 1847.4 2310.07 1848.28 L2310.07 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2350.18 1834 Q2346.57 1834 2344.74 1837.57 Q2342.94 1841.11 2342.94 1848.24 Q2342.94 1855.34 2344.74 1858.91 Q2346.57 1862.45 2350.18 1862.45 Q2353.81 1862.45 2355.62 1858.91 Q2357.45 1855.34 2357.45 1848.24 Q2357.45 1841.11 2355.62 1837.57 Q2353.81 1834 2350.18 1834 M2350.18 1830.3 Q2355.99 1830.3 2359.05 1834.9 Q2362.12 1839.49 2362.12 1848.24 Q2362.12 1856.96 2359.05 1861.57 Q2355.99 1866.15 2350.18 1866.15 Q2344.37 1866.15 2341.29 1861.57 Q2338.24 1856.96 2338.24 1848.24 Q2338.24 1839.49 2341.29 1834.9 Q2344.37 1830.3 2350.18 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="172.001,1469.4 2371.96,1469.4 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="172.001,1124.22 2371.96,1124.22 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="172.001,779.034 2371.96,779.034 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="172.001,433.85 2371.96,433.85 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="172.001,88.6662 2371.96,88.6662 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="172.001,1800.78 172.001,47.2441 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="172.001,1469.4 188.841,1469.4 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="172.001,1124.22 188.841,1124.22 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="172.001,779.034 188.841,779.034 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="172.001,433.85 188.841,433.85 "></polyline>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="172.001,88.6662 188.841,88.6662 "></polyline>
<path clip-path="url(#clip930)" d="M84.5982 1482.75 L100.918 1482.75 L100.918 1486.68 L78.9733 1486.68 L78.9733 1482.75 Q81.6353 1479.99 86.2186 1475.36 Q90.8251 1470.71 92.0056 1469.37 Q94.251 1466.84 95.1306 1465.11 Q96.0334 1463.35 96.0334 1461.66 Q96.0334 1458.9 94.0889 1457.17 Q92.1676 1455.43 89.0658 1455.43 Q86.8667 1455.43 84.4131 1456.2 Q81.9825 1456.96 79.2047 1458.51 L79.2047 1453.79 Q82.0288 1452.65 84.4825 1452.08 Q86.9362 1451.5 88.9732 1451.5 Q94.3436 1451.5 97.538 1454.18 Q100.732 1456.87 100.732 1461.36 Q100.732 1463.49 99.9222 1465.41 Q99.1352 1467.31 97.0287 1469.9 Q96.45 1470.57 93.3482 1473.79 Q90.2464 1476.98 84.5982 1482.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M110.779 1452.12 L129.135 1452.12 L129.135 1456.06 L115.061 1456.06 L115.061 1464.53 Q116.08 1464.18 117.098 1464.02 Q118.117 1463.84 119.135 1463.84 Q124.922 1463.84 128.302 1467.01 Q131.681 1470.18 131.681 1475.59 Q131.681 1481.17 128.209 1484.28 Q124.737 1487.35 118.417 1487.35 Q116.242 1487.35 113.973 1486.98 Q111.728 1486.61 109.32 1485.87 L109.32 1481.17 Q111.404 1482.31 113.626 1482.86 Q115.848 1483.42 118.325 1483.42 Q122.33 1483.42 124.667 1481.31 Q127.005 1479.21 127.005 1475.59 Q127.005 1471.98 124.667 1469.88 Q122.33 1467.77 118.325 1467.77 Q116.45 1467.77 114.575 1468.19 Q112.723 1468.6 110.779 1469.48 L110.779 1452.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M79.6214 1106.94 L97.9778 1106.94 L97.9778 1110.87 L83.9038 1110.87 L83.9038 1119.35 Q84.9223 1119 85.9408 1118.84 Q86.9593 1118.65 87.9778 1118.65 Q93.7649 1118.65 97.1445 1121.82 Q100.524 1124.99 100.524 1130.41 Q100.524 1135.99 97.0519 1139.09 Q93.5797 1142.17 87.2603 1142.17 Q85.0843 1142.17 82.8158 1141.8 Q80.5705 1141.43 78.1631 1140.69 L78.1631 1135.99 Q80.2464 1137.12 82.4686 1137.68 Q84.6908 1138.23 87.1677 1138.23 Q91.1723 1138.23 93.5102 1136.13 Q95.8482 1134.02 95.8482 1130.41 Q95.8482 1126.8 93.5102 1124.69 Q91.1723 1122.59 87.1677 1122.59 Q85.2927 1122.59 83.4177 1123 Q81.5658 1123.42 79.6214 1124.3 L79.6214 1106.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M119.737 1110.02 Q116.126 1110.02 114.297 1113.58 Q112.492 1117.12 112.492 1124.25 Q112.492 1131.36 114.297 1134.92 Q116.126 1138.47 119.737 1138.47 Q123.371 1138.47 125.177 1134.92 Q127.005 1131.36 127.005 1124.25 Q127.005 1117.12 125.177 1113.58 Q123.371 1110.02 119.737 1110.02 M119.737 1106.31 Q125.547 1106.31 128.603 1110.92 Q131.681 1115.5 131.681 1124.25 Q131.681 1132.98 128.603 1137.59 Q125.547 1142.17 119.737 1142.17 Q113.927 1142.17 110.848 1137.59 Q107.793 1132.98 107.793 1124.25 Q107.793 1115.5 110.848 1110.92 Q113.927 1106.31 119.737 1106.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M79.3899 761.754 L101.612 761.754 L101.612 763.745 L89.0658 796.314 L84.1816 796.314 L95.9871 765.69 L79.3899 765.69 L79.3899 761.754 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M110.779 761.754 L129.135 761.754 L129.135 765.69 L115.061 765.69 L115.061 774.162 Q116.08 773.814 117.098 773.652 Q118.117 773.467 119.135 773.467 Q124.922 773.467 128.302 776.639 Q131.681 779.81 131.681 785.226 Q131.681 790.805 128.209 793.907 Q124.737 796.986 118.417 796.986 Q116.242 796.986 113.973 796.615 Q111.728 796.245 109.32 795.504 L109.32 790.805 Q111.404 791.939 113.626 792.495 Q115.848 793.051 118.325 793.051 Q122.33 793.051 124.667 790.944 Q127.005 788.838 127.005 785.226 Q127.005 781.615 124.667 779.509 Q122.33 777.402 118.325 777.402 Q116.45 777.402 114.575 777.819 Q112.723 778.236 110.779 779.115 L110.779 761.754 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M50.2234 447.195 L57.8623 447.195 L57.8623 420.83 L49.5521 422.496 L49.5521 418.237 L57.816 416.57 L62.4919 416.57 L62.4919 447.195 L70.1307 447.195 L70.1307 451.13 L50.2234 451.13 L50.2234 447.195 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M89.5751 419.649 Q85.964 419.649 84.1353 423.214 Q82.3297 426.755 82.3297 433.885 Q82.3297 440.991 84.1353 444.556 Q85.964 448.098 89.5751 448.098 Q93.2093 448.098 95.0148 444.556 Q96.8435 440.991 96.8435 433.885 Q96.8435 426.755 95.0148 423.214 Q93.2093 419.649 89.5751 419.649 M89.5751 415.945 Q95.3852 415.945 98.4408 420.552 Q101.519 425.135 101.519 433.885 Q101.519 442.612 98.4408 447.218 Q95.3852 451.802 89.5751 451.802 Q83.7649 451.802 80.6862 447.218 Q77.6307 442.612 77.6307 433.885 Q77.6307 425.135 80.6862 420.552 Q83.7649 415.945 89.5751 415.945 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M119.737 419.649 Q116.126 419.649 114.297 423.214 Q112.492 426.755 112.492 433.885 Q112.492 440.991 114.297 444.556 Q116.126 448.098 119.737 448.098 Q123.371 448.098 125.177 444.556 Q127.005 440.991 127.005 433.885 Q127.005 426.755 125.177 423.214 Q123.371 419.649 119.737 419.649 M119.737 415.945 Q125.547 415.945 128.603 420.552 Q131.681 425.135 131.681 433.885 Q131.681 442.612 128.603 447.218 Q125.547 451.802 119.737 451.802 Q113.927 451.802 110.848 447.218 Q107.793 442.612 107.793 433.885 Q107.793 425.135 110.848 420.552 Q113.927 415.945 119.737 415.945 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M51.2188 102.011 L58.8576 102.011 L58.8576 75.6454 L50.5475 77.3121 L50.5475 73.0528 L58.8113 71.3862 L63.4872 71.3862 L63.4872 102.011 L71.1261 102.011 L71.1261 105.946 L51.2188 105.946 L51.2188 102.011 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M84.5982 102.011 L100.918 102.011 L100.918 105.946 L78.9733 105.946 L78.9733 102.011 Q81.6353 99.2564 86.2186 94.6268 Q90.8251 89.974 92.0056 88.6315 Q94.251 86.1083 95.1306 84.3722 Q96.0334 82.613 96.0334 80.9232 Q96.0334 78.1686 94.0889 76.4325 Q92.1676 74.6964 89.0658 74.6964 Q86.8667 74.6964 84.4131 75.4602 Q81.9825 76.2241 79.2047 77.775 L79.2047 73.0528 Q82.0288 71.9186 84.4825 71.3399 Q86.9362 70.7612 88.9732 70.7612 Q94.3436 70.7612 97.538 73.4464 Q100.732 76.1315 100.732 80.6222 Q100.732 82.7519 99.9222 84.6732 Q99.1352 86.5713 97.0287 89.1639 Q96.45 89.8352 93.3482 93.0527 Q90.2464 96.2472 84.5982 102.011 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M110.779 71.3862 L129.135 71.3862 L129.135 75.3214 L115.061 75.3214 L115.061 83.7935 Q116.08 83.4463 117.098 83.2843 Q118.117 83.0991 119.135 83.0991 Q124.922 83.0991 128.302 86.2704 Q131.681 89.4416 131.681 94.8583 Q131.681 100.437 128.209 103.539 Q124.737 106.617 118.417 106.617 Q116.242 106.617 113.973 106.247 Q111.728 105.877 109.32 105.136 L109.32 100.437 Q111.404 101.571 113.626 102.127 Q115.848 102.682 118.325 102.682 Q122.33 102.682 124.667 100.576 Q127.005 98.4694 127.005 94.8583 Q127.005 91.2472 124.667 89.1407 Q122.33 87.0343 118.325 87.0343 Q116.45 87.0343 114.575 87.4509 Q112.723 87.8676 110.779 88.7472 L110.779 71.3862 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip932)" style="stroke:#090621; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1447.02,668.575 1448.84,673.65 1451.77,682.383 1457.46,693.972 1458.55,696.19 1466.09,708.12 1467.36,709.998 1474.72,719.433 1478.59,723.805 1483.35,728.872 1491.97,736.677 1493.11,737.612 1500.6,743.982 1509.23,749.874 1511.8,751.42 1517.86,755.526 1526.48,760.406 1535.11,764.295 1537.47,765.227 1543.74,768.301 1552.36,771.821 1560.99,774.646 1569.62,776.907 1578.25,778.703 1580.18,779.034 1586.87,780.643 1595.5,782.25 1604.13,783.424 1612.76,784.21 1621.38,784.637 1630.01,784.72 1638.64,784.462 1647.26,783.854 1655.89,782.873 1664.52,781.484 1673.15,779.631 1675.42,779.034 1681.77,777.835 1690.4,775.811 1699.03,773.275 1707.66,770.113 1716.28,766.173 1718.12,765.227 1724.91,762.41 1733.54,758.044 1742.16,752.551 1743.78,751.42 1750.79,747.032 1759.42,740.355 1762.55,737.612 1768.05,732.927 1776.67,724.011 1776.86,723.805 1785.3,713.955 1788.31,709.998 1793.93,701.389 1797.14,696.19 1802.56,684.83 1803.73,682.383 1808.62,668.575 1811.18,656.229 1811.52,654.768 1813.05,640.961 1812.83,627.153 1811.18,615.67 1810.9,613.346 1807.59,599.539 1802.56,586.808 1802.15,585.731 1794.99,571.924 1793.93,570.276 1785.53,558.117 1785.3,557.83 1776.67,547.486 1773.63,544.309 1768.05,538.695 1759.42,531.455 1758.17,530.502 1750.79,524.572 1742.16,518.971 1738.06,516.694 1733.54,513.798 1724.91,509.057 1716.28,505.27 1709.69,502.887 1707.66,501.953 1699.03,498.467 1690.4,495.672 1681.77,493.441 1673.15,491.678 1664.52,490.312 1655.89,489.286 1653.49,489.08 1647.26,488.296 1638.64,487.616 1630.01,487.327 1621.38,487.42 1612.76,487.897 1604.13,488.776 1602.07,489.08 1595.5,489.746 1586.87,490.932 1578.25,492.484 1569.62,494.464 1560.99,496.956 1552.36,500.07 1545.92,502.887 1543.74,503.63 1535.11,507.01 1526.48,511.233 1517.86,516.531 1517.61,516.694 1509.23,521.534 1500.6,527.83 1497.38,530.502 1491.97,534.755 1483.35,542.955 1482.04,544.309 1474.72,552.179 1469.91,558.117 1466.09,563.476 1460.51,571.924 1457.46,577.695 1453.28,585.731 1448.84,597.799 1448.16,599.539 1444.51,613.346 1442.71,627.153 1442.52,640.961 1443.88,654.768 1447.02,668.575 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#1f0c47; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1472.54,668.575 1474.72,673.893 1478.13,682.383 1483.35,691.585 1486.08,696.19 1491.97,704.206 1496.72,709.998 1500.6,714.222 1509.23,722.39 1510.9,723.805 1517.86,729.628 1526.48,735.547 1529.98,737.612 1535.11,740.91 1543.74,745.605 1552.36,749.372 1558.02,751.42 1560.99,752.713 1569.62,755.922 1578.25,758.472 1586.87,760.47 1595.5,761.997 1604.13,763.113 1612.76,763.859 1621.38,764.264 1630.01,764.343 1638.64,764.098 1647.26,763.52 1655.89,762.589 1664.52,761.269 1673.15,759.509 1681.77,757.24 1690.4,754.367 1697.58,751.42 1699.03,750.929 1707.66,747.544 1716.28,743.328 1724.91,738.067 1725.59,737.612 1733.54,732.682 1742.16,726.02 1744.72,723.805 1750.79,718.449 1758.78,709.998 1759.42,709.248 1768.05,698.185 1769.47,696.19 1776.67,683.623 1777.36,682.383 1783.06,668.575 1785.3,659.512 1786.57,654.768 1788.27,640.961 1788.02,627.153 1785.79,613.346 1785.3,611.719 1781.86,599.539 1776.67,588.126 1775.59,585.731 1768.05,573.505 1767.01,571.924 1759.42,562.336 1755.62,558.117 1750.79,553.194 1742.16,545.699 1740.37,544.309 1733.54,538.952 1724.91,533.388 1719.57,530.502 1716.28,528.53 1707.66,524.024 1699.03,520.407 1690.4,517.507 1687.53,516.694 1681.77,514.671 1673.15,512.207 1664.52,510.296 1655.89,508.863 1647.26,507.851 1638.64,507.224 1630.01,506.958 1621.38,507.044 1612.76,507.484 1604.13,508.294 1595.5,509.506 1586.87,511.164 1578.25,513.333 1569.62,516.101 1568.04,516.694 1560.99,518.84 1552.36,522.071 1543.74,526.096 1536.05,530.502 1535.11,530.985 1526.48,535.942 1517.86,542.161 1515.21,544.309 1509.23,549.129 1500.6,557.555 1500.07,558.117 1491.97,567.43 1488.52,571.924 1483.35,580.047 1479.93,585.731 1474.72,597.568 1473.85,599.539 1469.67,613.346 1467.62,627.153 1467.4,640.961 1468.96,654.768 1472.54,668.575 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#3b0964; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1489.65,668.575 1491.97,673.688 1495.97,682.383 1500.6,689.682 1505.06,696.19 1509.23,701.221 1517.62,709.998 1517.86,710.226 1526.48,717.878 1534.83,723.805 1535.11,724.005 1543.74,729.668 1552.36,734.212 1560.35,737.612 1560.99,737.919 1569.62,741.548 1578.25,744.432 1586.87,746.692 1595.5,748.419 1604.13,749.681 1612.76,750.526 1621.38,750.984 1630.01,751.073 1638.64,750.796 1647.26,750.143 1655.89,749.089 1664.52,747.596 1673.15,745.605 1681.77,743.038 1690.4,739.789 1695.22,737.612 1699.03,736.09 1707.66,732.007 1716.28,726.921 1720.8,723.805 1724.91,721.022 1733.54,714.174 1738.05,709.998 1742.16,705.866 1750.45,696.19 1750.79,695.707 1759.42,682.517 1759.5,682.383 1765.94,668.575 1768.05,661.11 1769.92,654.768 1771.78,640.961 1771.51,627.153 1769.07,613.346 1768.05,610.278 1764.58,599.539 1759.42,589.335 1757.54,585.731 1750.79,575.986 1747.69,571.924 1742.16,565.753 1734.11,558.117 1733.54,557.604 1724.91,550.541 1716.28,544.898 1715.27,544.309 1707.66,539.661 1699.03,535.372 1690.4,531.932 1686.08,530.502 1681.77,528.839 1673.15,526.096 1664.52,523.969 1655.89,522.373 1647.26,521.247 1638.64,520.549 1630.01,520.252 1621.38,520.348 1612.76,520.837 1604.13,521.74 1595.5,523.089 1586.87,524.934 1578.25,527.35 1569.62,530.432 1569.45,530.502 1560.99,533.513 1552.36,537.345 1543.74,542.119 1540.31,544.309 1535.11,547.491 1526.48,553.783 1521.43,558.117 1517.86,561.364 1509.23,570.445 1507.95,571.924 1500.6,581.921 1498.04,585.731 1491.97,597.763 1491.1,599.539 1486.45,613.346 1484.18,627.153 1483.93,640.961 1485.66,654.768 1489.65,668.575 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#550f6d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1498.82,654.768 1500.6,660.308 1503.21,668.575 1509.23,680.335 1510.33,682.383 1517.86,692.823 1520.57,696.19 1526.48,702.392 1535.11,709.965 1535.15,709.998 1543.74,716.471 1552.36,721.693 1556.5,723.805 1560.99,726.217 1569.62,730.109 1578.25,733.201 1586.87,735.624 1595.5,737.476 1596.34,737.612 1604.13,739.126 1612.76,740.252 1621.38,740.863 1630.01,740.982 1638.64,740.612 1647.26,739.741 1655.89,738.336 1659.12,737.612 1664.52,736.593 1673.15,734.459 1681.77,731.707 1690.4,728.223 1699.03,723.859 1699.12,723.805 1707.66,719.159 1716.28,713.314 1720.49,709.998 1724.91,706.295 1733.54,697.792 1735.01,696.19 1742.16,686.914 1745.32,682.383 1750.79,671.748 1752.37,668.575 1756.8,654.768 1758.73,640.961 1758.45,627.153 1755.92,613.346 1750.79,599.633 1750.76,599.539 1742.96,585.731 1742.16,584.649 1733.54,573.899 1731.75,571.924 1724.91,565.32 1716.28,558.458 1715.8,558.117 1707.66,552.462 1699.03,547.622 1691.77,544.309 1690.4,543.637 1681.77,539.977 1673.15,537.085 1664.52,534.843 1655.89,533.16 1647.26,531.973 1638.64,531.237 1630.01,530.925 1621.38,531.025 1612.76,531.541 1604.13,532.493 1595.5,533.915 1586.87,535.861 1578.25,538.407 1569.62,541.656 1563.85,544.309 1560.99,545.524 1552.36,549.848 1543.74,555.234 1539.77,558.117 1535.11,561.612 1526.48,569.263 1523.83,571.924 1517.86,578.827 1512.58,585.731 1509.23,591.432 1504.73,599.539 1500.6,611.001 1499.75,613.346 1497.07,627.153 1496.78,640.961 1498.82,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#6e186e; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1507.84,640.961 1509.23,649.474 1510.05,654.768 1514.83,668.575 1517.86,674.093 1522.69,682.383 1526.48,687.27 1534.36,696.19 1535.11,696.913 1543.74,704.49 1551.47,709.998 1552.36,710.611 1560.99,715.85 1569.62,720.043 1578.25,723.375 1579.6,723.805 1586.87,726.335 1595.5,728.65 1604.13,730.341 1612.76,731.473 1621.38,732.087 1630.01,732.207 1638.64,731.835 1647.26,730.96 1655.89,729.547 1664.52,727.546 1673.15,724.878 1675.97,723.805 1681.77,721.765 1690.4,718.011 1699.03,713.309 1704.12,709.998 1707.66,707.619 1716.28,700.815 1721.26,696.19 1724.91,692.248 1732.85,682.383 1733.54,681.262 1740.73,668.575 1742.16,664.533 1745.61,654.768 1747.79,640.961 1747.48,627.153 1744.62,613.346 1742.16,607.192 1739.06,599.539 1733.54,590.548 1730.32,585.731 1724.91,579.394 1717.49,571.924 1716.28,570.856 1707.66,563.982 1699.03,558.463 1698.41,558.117 1690.4,553.646 1681.77,549.774 1673.15,546.715 1664.52,544.343 1664.36,544.309 1655.89,542.246 1647.26,540.762 1638.64,539.842 1630.01,539.452 1621.38,539.577 1612.76,540.223 1604.13,541.412 1595.5,543.189 1591.42,544.309 1586.87,545.42 1578.25,548.113 1569.62,551.55 1560.99,555.875 1557.2,558.117 1552.36,561.001 1543.74,567.143 1538.1,571.924 1535.11,574.783 1526.48,584.298 1525.3,585.731 1517.86,597.377 1516.57,599.539 1511,613.346 1509.23,622.109 1508.17,627.153 1507.84,640.961 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#88216a; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1517.68,640.961 1517.86,641.944 1520.02,654.768 1525.35,668.575 1526.48,670.504 1534.08,682.383 1535.11,683.613 1543.74,692.888 1547.33,696.19 1552.36,700.248 1560.99,706.103 1568.05,709.998 1569.62,710.847 1578.25,714.845 1586.87,717.978 1595.5,720.373 1604.13,722.122 1612.76,723.293 1619.68,723.805 1621.38,723.948 1630.01,724.092 1635.58,723.805 1638.64,723.668 1647.26,722.762 1655.89,721.301 1664.52,719.231 1673.15,716.472 1681.77,712.913 1687.52,709.998 1690.4,708.519 1699.03,703.263 1707.66,696.709 1708.27,696.19 1716.28,688.39 1721.54,682.383 1724.91,677.353 1730.28,668.575 1733.54,660.167 1735.58,654.768 1737.99,640.961 1737.64,627.153 1734.49,613.346 1733.54,611.128 1728.4,599.539 1724.91,594.272 1718.64,585.731 1716.28,583.195 1707.66,574.989 1703.87,571.924 1699.03,568.383 1690.4,563.073 1681.77,558.836 1680.02,558.117 1673.15,555.234 1664.52,552.388 1655.89,550.252 1647.26,548.745 1638.64,547.811 1630.01,547.414 1621.38,547.542 1612.76,548.197 1604.13,549.405 1595.5,551.21 1586.87,553.68 1578.25,556.912 1575.59,558.117 1569.62,560.779 1560.99,565.513 1552.36,571.428 1551.72,571.924 1543.74,578.763 1536.97,585.731 1535.11,588.137 1527.24,599.539 1526.48,601.168 1521.07,613.346 1518.03,627.153 1517.86,634.394 1517.68,640.961 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#a12b61; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1529.27,654.768 1535.11,668.507 1535.14,668.575 1543.74,680.934 1544.88,682.383 1552.36,689.802 1560.21,696.19 1560.99,696.758 1569.62,702.225 1578.25,706.569 1586.87,709.973 1586.95,709.998 1595.5,712.765 1604.13,714.806 1612.76,716.172 1621.38,716.913 1630.01,717.057 1638.64,716.609 1647.26,715.552 1655.89,713.848 1664.52,711.433 1668.49,709.998 1673.15,708.336 1681.77,704.47 1690.4,699.576 1695.36,696.19 1699.03,693.389 1707.66,685.589 1710.73,682.383 1716.28,674.916 1720.5,668.575 1724.91,658.219 1726.32,654.768 1728.95,640.961 1728.57,627.153 1725.12,613.346 1724.91,612.884 1718.4,599.539 1716.28,596.594 1707.66,585.979 1707.43,585.731 1699.03,578.269 1690.4,572.107 1690.1,571.924 1681.77,567.164 1673.15,563.258 1664.52,560.229 1656.53,558.117 1655.89,557.94 1647.26,556.183 1638.64,555.092 1630.01,554.63 1621.38,554.779 1612.76,555.543 1604.13,556.952 1599.28,558.117 1595.5,558.975 1586.87,561.604 1578.25,565.043 1569.62,569.432 1565.54,571.924 1560.99,574.939 1552.36,581.804 1548.16,585.731 1543.74,590.86 1537.2,599.539 1535.11,603.61 1530.43,613.346 1527.07,627.153 1526.7,640.961 1529.27,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#ba3655; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1538.05,654.768 1543.74,667.019 1544.52,668.575 1552.36,678.817 1555.53,682.383 1560.99,687.237 1569.62,693.61 1573.85,696.19 1578.25,698.626 1586.87,702.516 1595.5,705.489 1604.13,707.662 1612.76,709.116 1621.38,709.905 1626.6,709.998 1630.01,710.062 1631.11,709.998 1638.64,709.581 1647.26,708.456 1655.89,706.642 1664.52,704.072 1673.15,700.645 1681.77,696.226 1681.83,696.19 1690.4,690.522 1699.03,683.374 1700.08,682.383 1707.66,673.296 1711.09,668.575 1716.28,657.601 1717.54,654.768 1720.41,640.961 1719.99,627.153 1716.28,613.512 1716.24,613.346 1708.76,599.539 1707.66,598.137 1699.03,588.398 1696.26,585.731 1690.4,581.094 1681.77,575.473 1674.98,571.924 1673.15,571.028 1664.52,567.566 1655.89,564.969 1647.26,563.136 1638.64,562 1630.01,561.518 1621.38,561.673 1612.76,562.47 1604.13,563.939 1595.5,566.134 1586.87,569.138 1580.65,571.924 1578.25,573.062 1569.62,578.052 1560.99,584.331 1559.32,585.731 1552.36,592.877 1546.84,599.539 1543.74,604.951 1539.33,613.346 1535.63,627.153 1535.23,640.961 1538.05,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#d04544; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1546.59,654.768 1552.36,666.068 1553.78,668.575 1560.99,677.017 1566.45,682.383 1569.62,684.874 1578.25,690.571 1586.87,695.036 1589.69,696.19 1595.5,698.404 1604.13,700.848 1612.76,702.483 1621.38,703.371 1630.01,703.544 1638.64,703.007 1647.26,701.742 1655.89,699.701 1664.52,696.809 1665.97,696.19 1673.15,692.889 1681.77,687.818 1689.17,682.383 1690.4,681.256 1699.03,672.033 1701.82,668.575 1707.66,657.563 1709.01,654.768 1712.16,640.961 1711.71,627.153 1707.66,613.572 1707.59,613.346 1699.2,599.539 1699.03,599.339 1690.4,590.555 1684.62,585.731 1681.77,583.758 1673.15,578.762 1664.52,574.888 1655.89,571.981 1655.66,571.924 1647.26,569.92 1638.64,568.642 1630.01,568.099 1621.38,568.274 1612.76,569.17 1604.13,570.823 1600.2,571.924 1595.5,573.285 1586.87,576.647 1578.25,581.045 1570.96,585.731 1569.62,586.76 1560.99,594.592 1556.42,599.539 1552.36,605.809 1548.01,613.346 1543.91,627.153 1543.74,632.335 1543.45,640.961 1543.74,642.252 1546.59,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#e35832; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1555.06,654.768 1560.99,665.166 1563.2,668.575 1569.62,675.221 1578.12,682.383 1578.25,682.468 1586.87,687.429 1595.5,691.221 1604.13,693.991 1612.76,695.844 1615.69,696.19 1621.38,696.838 1630.01,697.029 1638.64,696.433 1640.15,696.19 1647.26,695.004 1655.89,692.691 1664.52,689.413 1673.15,685.043 1677.37,682.383 1681.77,678.972 1690.4,670.795 1692.41,668.575 1699.03,657.584 1700.54,654.768 1704.03,640.961 1703.52,627.153 1699.03,613.538 1698.96,613.346 1690.4,600.809 1689.39,599.539 1681.77,592.729 1673.15,586.575 1671.69,585.731 1664.52,582.187 1655.89,578.957 1647.26,576.679 1638.64,575.266 1630.01,574.667 1621.38,574.859 1612.76,575.85 1604.13,577.677 1595.5,580.406 1586.87,584.141 1583.95,585.731 1578.25,589.388 1569.62,596.303 1566.23,599.539 1560.99,606.622 1556.66,613.346 1552.36,626.194 1552.06,627.153 1551.56,640.961 1552.36,644.253 1555.06,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#f0701e; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1563.69,654.768 1569.62,663.958 1573.11,668.575 1578.25,673.188 1586.87,679.446 1592.07,682.383 1595.5,683.993 1604.13,687.04 1612.76,689.079 1621.38,690.186 1630.01,690.401 1638.64,689.731 1647.26,688.154 1655.89,685.61 1663.65,682.383 1664.52,681.948 1673.15,676.436 1681.77,669.329 1682.55,668.575 1690.4,657.291 1691.93,654.768 1695.84,640.961 1695.28,627.153 1690.4,614 1690.13,613.346 1681.77,602.618 1678.88,599.539 1673.15,595.145 1664.52,589.895 1655.89,585.956 1655.22,585.731 1647.26,583.427 1638.64,581.873 1630.01,581.214 1621.38,581.425 1612.76,582.516 1604.13,584.525 1600.58,585.731 1595.5,587.722 1586.87,592.278 1578.25,598.239 1576.68,599.539 1569.62,607.711 1565.51,613.346 1560.99,625.154 1560.29,627.153 1559.74,640.961 1560.99,645.583 1563.69,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#f98c09; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1572.74,654.768 1578.25,662.169 1584.04,668.575 1586.87,670.723 1595.5,675.94 1604.13,679.752 1612.76,682.303 1613.25,682.383 1621.38,683.521 1630.01,683.755 1638.64,683.025 1641.9,682.383 1647.26,681.146 1655.89,677.963 1664.52,673.452 1671.59,668.575 1673.15,667.02 1681.77,656.405 1682.9,654.768 1687.4,640.961 1686.75,627.153 1681.77,615.394 1680.78,613.346 1673.15,604.951 1666.95,599.539 1664.52,597.988 1655.89,593.691 1647.26,590.659 1638.64,588.779 1630.01,587.982 1621.38,588.238 1612.76,589.557 1604.13,591.987 1595.5,595.618 1588.62,599.539 1586.87,600.898 1578.25,609.324 1574.87,613.346 1569.62,625.087 1568.8,627.153 1568.17,640.961 1569.62,645.668 1572.74,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#fbaa0e; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1582.65,654.768 1586.87,659.572 1595.5,667.31 1597.37,668.575 1604.13,671.781 1612.76,674.545 1621.38,676.045 1630.01,676.336 1638.64,675.429 1647.26,673.291 1655.89,669.843 1658.21,668.575 1664.52,663.62 1673.09,654.768 1673.15,654.635 1678.39,640.961 1677.63,627.153 1673.15,618.072 1670.35,613.346 1664.52,608.015 1655.89,601.984 1651.01,599.539 1647.26,598.141 1638.64,596.105 1630.01,595.241 1621.38,595.518 1612.76,596.947 1604.26,599.539 1604.13,599.592 1595.5,604.689 1586.87,611.665 1585.2,613.346 1578.25,626.338 1577.87,627.153 1577.14,640.961 1578.25,644.07 1582.65,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#f8c931; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1594.21,654.768 1595.5,655.962 1604.13,662.051 1612.76,666.126 1621.38,668.338 1626.16,668.575 1630.01,668.715 1631.26,668.575 1638.64,667.43 1647.26,664.277 1655.89,659.194 1661.28,654.768 1664.52,649.179 1668.31,640.961 1667.38,627.153 1664.52,622.34 1657.74,613.346 1655.89,612.006 1647.26,607.423 1638.64,604.581 1630.01,603.376 1621.38,603.763 1612.76,605.757 1604.13,609.43 1597.91,613.346 1595.5,616.09 1588.16,627.153 1587.14,640.961 1594.21,654.768 "></polyline>
<polyline clip-path="url(#clip932)" style="stroke:#f1e864; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1599.76,640.961 1604.13,647.47 1611.27,654.768 1612.76,655.503 1621.38,657.873 1630.01,658.333 1638.64,656.901 1644.13,654.768 1647.26,652.265 1655.89,641.316 1656.1,640.961 1655.89,638.589 1654.58,627.153 1647.26,619.926 1638.64,614.614 1633.8,613.346 1630.01,612.781 1621.38,613.196 1620.77,613.346 1612.76,616.811 1604.13,623.677 1601.13,627.153 1599.76,640.961 "></polyline>
<defs>
  <clippath id="clip933">
    <rect x="2425" y="47" width="82" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip933)" style="stroke:#0a0723; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,1691.18 2506.36,1691.18 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#200c4a; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,1581.59 2506.36,1581.59 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#3c0965; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,1471.99 2506.36,1471.99 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#570f6d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,1362.4 2506.36,1362.4 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#70196e; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,1252.8 2506.36,1252.8 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#892269; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,1143.2 2506.36,1143.2 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#a32b61; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,1033.61 2506.36,1033.61 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#bb3754; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,924.012 2506.36,924.012 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#d04544; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,814.416 2506.36,814.416 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#e35832; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,704.82 2506.36,704.82 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#f0701e; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,595.224 2506.36,595.224 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#f98c09; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,485.628 2506.36,485.628 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#fbaa0e; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,376.032 2506.36,376.032 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#f8c931; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,266.436 2506.36,266.436 "></polyline>
<polyline clip-path="url(#clip933)" style="stroke:#f1e864; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2425.72,156.84 2506.36,156.84 "></polyline>
<path clip-path="url(#clip930)" d="M2558.62 1606.94 Q2555.01 1606.94 2553.18 1610.51 Q2551.37 1614.05 2551.37 1621.18 Q2551.37 1628.28 2553.18 1631.85 Q2555.01 1635.39 2558.62 1635.39 Q2562.25 1635.39 2564.06 1631.85 Q2565.89 1628.28 2565.89 1621.18 Q2565.89 1614.05 2564.06 1610.51 Q2562.25 1606.94 2558.62 1606.94 M2558.62 1603.24 Q2564.43 1603.24 2567.49 1607.84 Q2570.56 1612.43 2570.56 1621.18 Q2570.56 1629.9 2567.49 1634.51 Q2564.43 1639.09 2558.62 1639.09 Q2552.81 1639.09 2549.73 1634.51 Q2546.68 1629.9 2546.68 1621.18 Q2546.68 1612.43 2549.73 1607.84 Q2552.81 1603.24 2558.62 1603.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 1632.54 L2583.67 1632.54 L2583.67 1638.42 L2578.78 1638.42 L2578.78 1632.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2594.66 1634.49 L2602.3 1634.49 L2602.3 1608.12 L2593.99 1609.79 L2593.99 1605.53 L2602.25 1603.86 L2606.93 1603.86 L2606.93 1634.49 L2614.57 1634.49 L2614.57 1638.42 L2594.66 1638.42 L2594.66 1634.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2558.62 1430.93 Q2555.01 1430.93 2553.18 1434.5 Q2551.37 1438.04 2551.37 1445.17 Q2551.37 1452.28 2553.18 1455.84 Q2555.01 1459.38 2558.62 1459.38 Q2562.25 1459.38 2564.06 1455.84 Q2565.89 1452.28 2565.89 1445.17 Q2565.89 1438.04 2564.06 1434.5 Q2562.25 1430.93 2558.62 1430.93 M2558.62 1427.23 Q2564.43 1427.23 2567.49 1431.84 Q2570.56 1436.42 2570.56 1445.17 Q2570.56 1453.9 2567.49 1458.5 Q2564.43 1463.09 2558.62 1463.09 Q2552.81 1463.09 2549.73 1458.5 Q2546.68 1453.9 2546.68 1445.17 Q2546.68 1436.42 2549.73 1431.84 Q2552.81 1427.23 2558.62 1427.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 1456.53 L2583.67 1456.53 L2583.67 1462.41 L2578.78 1462.41 L2578.78 1456.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2597.88 1458.48 L2614.2 1458.48 L2614.2 1462.41 L2592.25 1462.41 L2592.25 1458.48 Q2594.92 1455.72 2599.5 1451.09 Q2604.11 1446.44 2605.29 1445.1 Q2607.53 1442.58 2608.41 1440.84 Q2609.31 1439.08 2609.31 1437.39 Q2609.31 1434.64 2607.37 1432.9 Q2605.45 1431.16 2602.35 1431.16 Q2600.15 1431.16 2597.69 1431.93 Q2595.26 1432.69 2592.49 1434.24 L2592.49 1429.52 Q2595.31 1428.39 2597.76 1427.81 Q2600.22 1427.23 2602.25 1427.23 Q2607.62 1427.23 2610.82 1429.91 Q2614.01 1432.6 2614.01 1437.09 Q2614.01 1439.22 2613.2 1441.14 Q2612.42 1443.04 2610.31 1445.63 Q2609.73 1446.3 2606.63 1449.52 Q2603.53 1452.71 2597.88 1458.48 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2558.62 1254.92 Q2555.01 1254.92 2553.18 1258.49 Q2551.37 1262.03 2551.37 1269.16 Q2551.37 1276.27 2553.18 1279.83 Q2555.01 1283.37 2558.62 1283.37 Q2562.25 1283.37 2564.06 1279.83 Q2565.89 1276.27 2565.89 1269.16 Q2565.89 1262.03 2564.06 1258.49 Q2562.25 1254.92 2558.62 1254.92 M2558.62 1251.22 Q2564.43 1251.22 2567.49 1255.83 Q2570.56 1260.41 2570.56 1269.16 Q2570.56 1277.89 2567.49 1282.49 Q2564.43 1287.08 2558.62 1287.08 Q2552.81 1287.08 2549.73 1282.49 Q2546.68 1277.89 2546.68 1269.16 Q2546.68 1260.41 2549.73 1255.83 Q2552.81 1251.22 2558.62 1251.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 1280.53 L2583.67 1280.53 L2583.67 1286.41 L2578.78 1286.41 L2578.78 1280.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2608.02 1267.77 Q2611.37 1268.49 2613.25 1270.76 Q2615.15 1273.03 2615.15 1276.36 Q2615.15 1281.47 2611.63 1284.28 Q2608.11 1287.08 2601.63 1287.08 Q2599.45 1287.08 2597.14 1286.64 Q2594.85 1286.22 2592.39 1285.36 L2592.39 1280.85 Q2594.34 1281.98 2596.65 1282.56 Q2598.97 1283.14 2601.49 1283.14 Q2605.89 1283.14 2608.18 1281.41 Q2610.5 1279.67 2610.5 1276.36 Q2610.5 1273.3 2608.34 1271.59 Q2606.21 1269.85 2602.39 1269.85 L2598.37 1269.85 L2598.37 1266.01 L2602.58 1266.01 Q2606.03 1266.01 2607.86 1264.65 Q2609.68 1263.26 2609.68 1260.66 Q2609.68 1258 2607.79 1256.59 Q2605.91 1255.16 2602.39 1255.16 Q2600.47 1255.16 2598.27 1255.57 Q2596.07 1255.99 2593.43 1256.87 L2593.43 1252.7 Q2596.1 1251.96 2598.41 1251.59 Q2600.75 1251.22 2602.81 1251.22 Q2608.13 1251.22 2611.24 1253.65 Q2614.34 1256.06 2614.34 1260.18 Q2614.34 1263.05 2612.69 1265.04 Q2611.05 1267.01 2608.02 1267.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2558.62 1078.92 Q2555.01 1078.92 2553.18 1082.48 Q2551.37 1086.02 2551.37 1093.15 Q2551.37 1100.26 2553.18 1103.82 Q2555.01 1107.36 2558.62 1107.36 Q2562.25 1107.36 2564.06 1103.82 Q2565.89 1100.26 2565.89 1093.15 Q2565.89 1086.02 2564.06 1082.48 Q2562.25 1078.92 2558.62 1078.92 M2558.62 1075.21 Q2564.43 1075.21 2567.49 1079.82 Q2570.56 1084.4 2570.56 1093.15 Q2570.56 1101.88 2567.49 1106.49 Q2564.43 1111.07 2558.62 1111.07 Q2552.81 1111.07 2549.73 1106.49 Q2546.68 1101.88 2546.68 1093.15 Q2546.68 1084.4 2549.73 1079.82 Q2552.81 1075.21 2558.62 1075.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 1104.52 L2583.67 1104.52 L2583.67 1110.4 L2578.78 1110.4 L2578.78 1104.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2606.7 1079.91 L2594.89 1098.36 L2606.7 1098.36 L2606.7 1079.91 M2605.47 1075.84 L2611.35 1075.84 L2611.35 1098.36 L2616.28 1098.36 L2616.28 1102.25 L2611.35 1102.25 L2611.35 1110.4 L2606.7 1110.4 L2606.7 1102.25 L2591.1 1102.25 L2591.1 1097.74 L2605.47 1075.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2558.62 902.908 Q2555.01 902.908 2553.18 906.472 Q2551.37 910.014 2551.37 917.144 Q2551.37 924.25 2553.18 927.815 Q2555.01 931.356 2558.62 931.356 Q2562.25 931.356 2564.06 927.815 Q2565.89 924.25 2565.89 917.144 Q2565.89 910.014 2564.06 906.472 Q2562.25 902.908 2558.62 902.908 M2558.62 899.204 Q2564.43 899.204 2567.49 903.81 Q2570.56 908.394 2570.56 917.144 Q2570.56 925.87 2567.49 930.477 Q2564.43 935.06 2558.62 935.06 Q2552.81 935.06 2549.73 930.477 Q2546.68 925.87 2546.68 917.144 Q2546.68 908.394 2549.73 903.81 Q2552.81 899.204 2558.62 899.204 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 928.509 L2583.67 928.509 L2583.67 934.389 L2578.78 934.389 L2578.78 928.509 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2593.9 899.829 L2612.25 899.829 L2612.25 903.764 L2598.18 903.764 L2598.18 912.236 Q2599.2 911.889 2600.22 911.727 Q2601.24 911.542 2602.25 911.542 Q2608.04 911.542 2611.42 914.713 Q2614.8 917.884 2614.8 923.301 Q2614.8 928.88 2611.33 931.981 Q2607.86 935.06 2601.54 935.06 Q2599.36 935.06 2597.09 934.69 Q2594.85 934.319 2592.44 933.579 L2592.44 928.88 Q2594.52 930.014 2596.75 930.569 Q2598.97 931.125 2601.44 931.125 Q2605.45 931.125 2607.79 929.019 Q2610.12 926.912 2610.12 923.301 Q2610.12 919.69 2607.79 917.583 Q2605.45 915.477 2601.44 915.477 Q2599.57 915.477 2597.69 915.894 Q2595.84 916.31 2593.9 917.19 L2593.9 899.829 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2558.62 726.899 Q2555.01 726.899 2553.18 730.464 Q2551.37 734.006 2551.37 741.135 Q2551.37 748.242 2553.18 751.806 Q2555.01 755.348 2558.62 755.348 Q2562.25 755.348 2564.06 751.806 Q2565.89 748.242 2565.89 741.135 Q2565.89 734.006 2564.06 730.464 Q2562.25 726.899 2558.62 726.899 M2558.62 723.196 Q2564.43 723.196 2567.49 727.802 Q2570.56 732.385 2570.56 741.135 Q2570.56 749.862 2567.49 754.468 Q2564.43 759.052 2558.62 759.052 Q2552.81 759.052 2549.73 754.468 Q2546.68 749.862 2546.68 741.135 Q2546.68 732.385 2549.73 727.802 Q2552.81 723.196 2558.62 723.196 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 752.501 L2583.67 752.501 L2583.67 758.381 L2578.78 758.381 L2578.78 752.501 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2604.43 739.237 Q2601.28 739.237 2599.43 741.39 Q2597.6 743.543 2597.6 747.293 Q2597.6 751.019 2599.43 753.195 Q2601.28 755.348 2604.43 755.348 Q2607.58 755.348 2609.41 753.195 Q2611.26 751.019 2611.26 747.293 Q2611.26 743.543 2609.41 741.39 Q2607.58 739.237 2604.43 739.237 M2613.71 724.584 L2613.71 728.844 Q2611.95 728.01 2610.15 727.57 Q2608.37 727.131 2606.61 727.131 Q2601.98 727.131 2599.52 730.256 Q2597.09 733.381 2596.75 739.7 Q2598.11 737.686 2600.17 736.621 Q2602.23 735.533 2604.71 735.533 Q2609.92 735.533 2612.93 738.705 Q2615.96 741.853 2615.96 747.293 Q2615.96 752.617 2612.81 755.834 Q2609.66 759.052 2604.43 759.052 Q2598.43 759.052 2595.26 754.468 Q2592.09 749.862 2592.09 741.135 Q2592.09 732.941 2595.98 728.08 Q2599.87 723.196 2606.42 723.196 Q2608.18 723.196 2609.96 723.543 Q2611.77 723.89 2613.71 724.584 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2558.62 550.891 Q2555.01 550.891 2553.18 554.456 Q2551.37 557.997 2551.37 565.127 Q2551.37 572.233 2553.18 575.798 Q2555.01 579.34 2558.62 579.34 Q2562.25 579.34 2564.06 575.798 Q2565.89 572.233 2565.89 565.127 Q2565.89 557.997 2564.06 554.456 Q2562.25 550.891 2558.62 550.891 M2558.62 547.187 Q2564.43 547.187 2567.49 551.794 Q2570.56 556.377 2570.56 565.127 Q2570.56 573.854 2567.49 578.46 Q2564.43 583.043 2558.62 583.043 Q2552.81 583.043 2549.73 578.46 Q2546.68 573.854 2546.68 565.127 Q2546.68 556.377 2549.73 551.794 Q2552.81 547.187 2558.62 547.187 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 576.493 L2583.67 576.493 L2583.67 582.372 L2578.78 582.372 L2578.78 576.493 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2592.67 547.812 L2614.89 547.812 L2614.89 549.803 L2602.35 582.372 L2597.46 582.372 L2609.27 551.747 L2592.67 551.747 L2592.67 547.812 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2558.62 374.883 Q2555.01 374.883 2553.18 378.447 Q2551.37 381.989 2551.37 389.119 Q2551.37 396.225 2553.18 399.79 Q2555.01 403.331 2558.62 403.331 Q2562.25 403.331 2564.06 399.79 Q2565.89 396.225 2565.89 389.119 Q2565.89 381.989 2564.06 378.447 Q2562.25 374.883 2558.62 374.883 M2558.62 371.179 Q2564.43 371.179 2567.49 375.785 Q2570.56 380.369 2570.56 389.119 Q2570.56 397.845 2567.49 402.452 Q2564.43 407.035 2558.62 407.035 Q2552.81 407.035 2549.73 402.452 Q2546.68 397.845 2546.68 389.119 Q2546.68 380.369 2549.73 375.785 Q2552.81 371.179 2558.62 371.179 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 400.484 L2583.67 400.484 L2583.67 406.364 L2578.78 406.364 L2578.78 400.484 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2603.85 389.952 Q2600.52 389.952 2598.6 391.734 Q2596.7 393.517 2596.7 396.642 Q2596.7 399.767 2598.6 401.549 Q2600.52 403.331 2603.85 403.331 Q2607.18 403.331 2609.11 401.549 Q2611.03 399.744 2611.03 396.642 Q2611.03 393.517 2609.11 391.734 Q2607.21 389.952 2603.85 389.952 M2599.18 387.961 Q2596.17 387.22 2594.48 385.16 Q2592.81 383.1 2592.81 380.137 Q2592.81 375.994 2595.75 373.586 Q2598.71 371.179 2603.85 371.179 Q2609.01 371.179 2611.95 373.586 Q2614.89 375.994 2614.89 380.137 Q2614.89 383.1 2613.2 385.16 Q2611.54 387.22 2608.55 387.961 Q2611.93 388.748 2613.81 391.04 Q2615.7 393.332 2615.7 396.642 Q2615.7 401.665 2612.62 404.35 Q2609.57 407.035 2603.85 407.035 Q2598.13 407.035 2595.06 404.35 Q2592 401.665 2592 396.642 Q2592 393.332 2593.9 391.04 Q2595.8 388.748 2599.18 387.961 M2597.46 380.577 Q2597.46 383.262 2599.13 384.767 Q2600.82 386.271 2603.85 386.271 Q2606.86 386.271 2608.55 384.767 Q2610.26 383.262 2610.26 380.577 Q2610.26 377.892 2608.55 376.387 Q2606.86 374.883 2603.85 374.883 Q2600.82 374.883 2599.13 376.387 Q2597.46 377.892 2597.46 380.577 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2558.62 198.874 Q2555.01 198.874 2553.18 202.439 Q2551.37 205.981 2551.37 213.11 Q2551.37 220.217 2553.18 223.781 Q2555.01 227.323 2558.62 227.323 Q2562.25 227.323 2564.06 223.781 Q2565.89 220.217 2565.89 213.11 Q2565.89 205.981 2564.06 202.439 Q2562.25 198.874 2558.62 198.874 M2558.62 195.171 Q2564.43 195.171 2567.49 199.777 Q2570.56 204.36 2570.56 213.11 Q2570.56 221.837 2567.49 226.443 Q2564.43 231.027 2558.62 231.027 Q2552.81 231.027 2549.73 226.443 Q2546.68 221.837 2546.68 213.11 Q2546.68 204.36 2549.73 199.777 Q2552.81 195.171 2558.62 195.171 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2578.78 224.476 L2583.67 224.476 L2583.67 230.356 L2578.78 230.356 L2578.78 224.476 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip930)" d="M2593.99 229.638 L2593.99 225.379 Q2595.75 226.212 2597.56 226.652 Q2599.36 227.092 2601.1 227.092 Q2605.73 227.092 2608.16 223.99 Q2610.61 220.865 2610.96 214.522 Q2609.62 216.513 2607.56 217.578 Q2605.5 218.643 2603 218.643 Q2597.81 218.643 2594.78 215.518 Q2591.77 212.369 2591.77 206.93 Q2591.77 201.606 2594.92 198.388 Q2598.06 195.171 2603.3 195.171 Q2609.29 195.171 2612.44 199.777 Q2615.61 204.36 2615.61 213.11 Q2615.61 221.281 2611.72 226.166 Q2607.86 231.027 2601.31 231.027 Q2599.55 231.027 2597.74 230.68 Q2595.93 230.332 2593.99 229.638 M2603.3 214.985 Q2606.44 214.985 2608.27 212.832 Q2610.12 210.68 2610.12 206.93 Q2610.12 203.203 2608.27 201.05 Q2606.44 198.874 2603.3 198.874 Q2600.15 198.874 2598.3 201.05 Q2596.47 203.203 2596.47 206.93 Q2596.47 210.68 2598.3 212.832 Q2600.15 214.985 2603.3 214.985 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2506.36,1800.78 2506.36,1624.77 2533.24,1624.77 2506.36,1624.77 2506.36,1448.76 2533.24,1448.76 2506.36,1448.76 2506.36,1272.75 2533.24,1272.75 2506.36,1272.75 2506.36,1096.75 2533.24,1096.75 2506.36,1096.75 2506.36,920.738 2533.24,920.738 2506.36,920.738 2506.36,744.729 2533.24,744.729 2506.36,744.729 2506.36,568.721 2533.24,568.721 2506.36,568.721 2506.36,392.713 2533.24,392.713 2506.36,392.713 2506.36,216.704 2533.24,216.704 2506.36,216.704 2506.36,47.2441 "></polyline>
</svg>
</div>
</div>
</section>
<section id="create-the-gif-to-show-what-we-are-computing" class="level2">
<h2 class="anchored" data-anchor-id="create-the-gif-to-show-what-we-are-computing">Create the gif to show what we are computing</h2>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">create_gif_animation</span>(mesh, nsteps)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@gif</span> <span class="cf">for</span> t <span class="kw">in</span> <span class="fu">LinRange</span>(<span class="fl">0</span>, <span class="fl">2</span>π, nsteps)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">f</span>(x,y) <span class="op">=</span> <span class="fu">exp</span>(<span class="fu">-</span>((<span class="fu">cos</span>(t)<span class="fu">*x-sin</span>(t)<span class="op">*</span>y)<span class="op">-</span><span class="fl">1</span>)<span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">0.2</span>)<span class="fu">*exp</span>(<span class="fu">-</span>((<span class="fu">sin</span>(t)<span class="fu">*x+cos</span>(t)<span class="op">*</span>y)<span class="op">-</span><span class="fl">1</span>)<span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">0.2</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="fu">plot</span>(mesh.x, mesh.y, f, st <span class="op">=</span> [<span class="op">:</span>contour])</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot!</span>(p[<span class="fl">1</span>])</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot!</span>(zlims<span class="op">=</span>(<span class="op">-</span><span class="fl">0.01</span>,<span class="fl">1.01</span>))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>create_gif_animation (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_gif_animation</span>(mesh, <span class="fl">100</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[ Info: Saved animation to /home/runner/work/math-julia/math-julia/tmp.gif</code></pre>
</div>
</div>
<p><img src="diffeq/tmp.gif" class="img-fluid"></p>
</section>
<section id="function-to-compute-error" class="level2">
<h2 class="anchored" data-anchor-id="function-to-compute-error">Function to compute error</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">compute_error</span>(f, f_exact)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">maximum</span>(<span class="fu">abs</span>.(f <span class="op">.-</span> f_exact))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>compute_error (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="naive-translation-of-a-matlab-code" class="level2">
<h2 class="anchored" data-anchor-id="naive-translation-of-a-matlab-code">Naive translation of a matlab code</h2>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">naive_translation_from_matlab</span>(final_time, nsteps, mesh<span class="op">::</span><span class="dt">TwoDMesh</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> final_time<span class="op">/</span>nsteps</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    kx <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.xmax<span class="op">-</span>mesh.xmin) <span class="op">.*</span> <span class="fu">fftfreq</span>(mesh.nx, mesh.nx)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    ky <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.ymax<span class="op">-</span>mesh.ymin) <span class="op">.*</span> <span class="fu">fftfreq</span>(mesh.ny, mesh.ny)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="fu">compute_exact_solution</span>(<span class="fl">0.0</span>, mesh)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n<span class="op">=</span><span class="fl">1</span><span class="op">:</span>nsteps</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span> (i, x) <span class="kw">in</span> <span class="fu">enumerate</span>(mesh.x)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>           f[i,<span class="op">:</span>]<span class="op">=</span><span class="fu">real</span>(<span class="fu">ifft</span>(<span class="fu">exp</span>.(<span class="fl">1im</span><span class="fu">*x*ky*tan</span>(dt<span class="op">/</span><span class="fl">2</span>))<span class="op">.*</span><span class="fu">fft</span>(f[i,<span class="op">:</span>])))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>       <span class="cf">end</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span> (j, y) <span class="kw">in</span> <span class="fu">enumerate</span>(mesh.y)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>           f[<span class="op">:</span>,j]<span class="op">=</span><span class="fu">real</span>(<span class="fu">ifft</span>(<span class="fu">exp</span>.(<span class="fu">-1im*y*kx*sin</span>(dt))<span class="op">.*</span><span class="fu">fft</span>(f[<span class="op">:</span>,j])))</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>       <span class="cf">end</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span> (i, x) <span class="kw">in</span> <span class="fu">enumerate</span>(mesh.x)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>           f[i,<span class="op">:</span>]<span class="op">=</span><span class="fu">real</span>(<span class="fu">ifft</span>(<span class="fu">exp</span>.(<span class="fl">1im</span><span class="fu">*x*ky*tan</span>(dt<span class="op">/</span><span class="fl">2</span>))<span class="op">.*</span><span class="fu">fft</span>(f[i,<span class="op">:</span>])))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>       <span class="cf">end</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>   <span class="cf">end</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>   f</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>naive_translation_from_matlab (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nsteps, final_time <span class="op">=</span> <span class="fl">1000</span>, <span class="fl">200</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> <span class="fu">naive_translation_from_matlab</span>(final_time, nsteps, mesh)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> <span class="fu">compute_exact_solution</span>(final_time, mesh)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>( <span class="st">" error = "</span>, <span class="fu">compute_error</span>(sol1, sol2))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">naive_translation_from_matlab</span>(final_time, nsteps, mesh);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> error = 1.9817480989559044e-13
  10.580 s (7168002 allocations: 7.95 GiB)</code></pre>
</div>
</div>
<section id="vectorized-version" class="level3">
<h3 class="anchored" data-anchor-id="vectorized-version">Vectorized version</h3>
<ul>
<li>We remove the for loops over direction <code>x</code> and <code>y</code> by creating the 2d arrays <code>exky</code> and <code>ekxy</code>.</li>
<li>We save cpu time by computing them before the loop over time</li>
</ul>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">vectorized</span>(final_time, nsteps, mesh<span class="op">::</span><span class="dt">TwoDMesh</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> final_time<span class="op">/</span>nsteps</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    kx <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.xmax<span class="op">-</span>mesh.xmin) <span class="op">.*</span> <span class="fu">fftfreq</span>(mesh.nx, mesh.nx)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    ky <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.ymax<span class="op">-</span>mesh.ymin) <span class="op">.*</span> <span class="fu">fftfreq</span>(mesh.ny, mesh.ny)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="fu">compute_exact_solution</span>(<span class="fl">0.0</span>, mesh)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    exky <span class="op">=</span> <span class="fu">exp</span>.( <span class="fl">1im</span><span class="fu">*tan</span>(dt<span class="op">/</span><span class="fl">2</span>) <span class="op">.*</span> mesh.x  <span class="op">.*</span> ky<span class="op">'</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    ekxy <span class="op">=</span> <span class="fu">exp</span>.(<span class="fu">-1im*sin</span>(dt)   <span class="op">.*</span> mesh.y<span class="op">'</span> <span class="op">.*</span> kx )</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>nsteps</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> <span class="fu">real</span>(<span class="fu">ifft</span>(exky <span class="op">.*</span> <span class="fu">fft</span>(f, <span class="fl">2</span>), <span class="fl">2</span>))</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> <span class="fu">real</span>(<span class="fu">ifft</span>(ekxy <span class="op">.*</span> <span class="fu">fft</span>(f, <span class="fl">1</span>), <span class="fl">1</span>))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> <span class="fu">real</span>(<span class="fu">ifft</span>(exky <span class="op">.*</span> <span class="fu">fft</span>(f, <span class="fl">2</span>), <span class="fl">2</span>))</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    f</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>vectorized (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>nsteps, final_time <span class="op">=</span> <span class="fl">1000</span>, <span class="fl">200</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> <span class="fu">vectorized</span>(final_time, nsteps, mesh)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> <span class="fu">compute_exact_solution</span>(final_time, mesh)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>( <span class="st">" error = "</span>, <span class="fu">compute_error</span>(sol1, sol2))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">vectorized</span>(final_time, nsteps, mesh);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> error = 1.7908811801681452e-13
  2.219 s (48006 allocations: 6.60 GiB)</code></pre>
</div>
</div>
</section>
</section>
<section id="inplace-computation" class="level2">
<h2 class="anchored" data-anchor-id="inplace-computation">Inplace computation</h2>
<ul>
<li>We remove the Float64-Complex128 conversion by allocating the distribution function <code>f</code> as a Complex array</li>
<li>Note that we need to use the inplace assignement operator “.=” to initialize the <code>f</code> array.</li>
<li>We use inplace computation for fft with the “bang” operator <code>!</code></li>
</ul>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">inplace</span>(final_time, nsteps, mesh<span class="op">::</span><span class="dt">TwoDMesh</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> final_time<span class="op">/</span>nsteps</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    kx <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.xmax<span class="op">-</span>mesh.xmin)<span class="op">*</span>[<span class="fl">0</span><span class="op">:</span>mesh.nx<span class="op">÷</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span>;mesh.nx<span class="op">÷</span><span class="fl">2</span><span class="op">-</span>mesh.nx<span class="op">:-</span><span class="fl">1</span>]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    ky <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.ymax<span class="op">-</span>mesh.ymin)<span class="op">*</span>[<span class="fl">0</span><span class="op">:</span>mesh.ny<span class="op">÷</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span>;mesh.ny<span class="op">÷</span><span class="fl">2</span><span class="op">-</span>mesh.ny<span class="op">:-</span><span class="fl">1</span>]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    f  <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">ComplexF64</span>,(mesh.nx,mesh.ny))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    f <span class="op">.=</span> <span class="fu">compute_exact_solution</span>(<span class="fl">0.0</span>, mesh)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    exky <span class="op">=</span> <span class="fu">exp</span>.( <span class="fl">1im</span><span class="fu">*tan</span>(dt<span class="op">/</span><span class="fl">2</span>) <span class="op">.*</span> mesh.x  <span class="op">.*</span> ky<span class="op">'</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    ekxy <span class="op">=</span> <span class="fu">exp</span>.(<span class="fu">-1im*sin</span>(dt)   <span class="op">.*</span> mesh.y<span class="op">'</span> <span class="op">.*</span> kx )</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>nsteps</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fft!</span>(f, <span class="fl">2</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> exky <span class="op">.*</span> f</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifft!</span>(f,<span class="fl">2</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fft!</span>(f, <span class="fl">1</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> ekxy <span class="op">.*</span> f</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifft!</span>(f, <span class="fl">1</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fft!</span>(f, <span class="fl">2</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> exky <span class="op">.*</span> f</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifft!</span>(f,<span class="fl">2</span>)        </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">real</span>(f)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>inplace (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>nsteps, final_time <span class="op">=</span> <span class="fl">1000</span>, <span class="fl">200</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> <span class="fu">inplace</span>(final_time, nsteps, mesh)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> <span class="fu">compute_exact_solution</span>(final_time, mesh)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>( <span class="st">" error = "</span>, <span class="fu">compute_error</span>(sol1, sol2))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">inplace</span>(final_time, nsteps, mesh);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> error = 1.8686623861233415e-13
  1.493 s (18014 allocations: 3.56 MiB)</code></pre>
</div>
</div>
<section id="use-plans-for-fft" class="level3">
<h3 class="anchored" data-anchor-id="use-plans-for-fft">Use plans for fft</h3>
<ul>
<li>When you apply multiple fft on array with same shape and size, it is recommended to use fftw plan to improve computations.</li>
<li>Let’s try to initialize our two fft along x and y with plans.</li>
</ul>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">with_fft_plans</span>(final_time, nsteps, mesh<span class="op">::</span><span class="dt">TwoDMesh</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> final_time<span class="op">/</span>nsteps</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    kx <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.xmax<span class="op">-</span>mesh.xmin)<span class="op">*</span>[<span class="fl">0</span><span class="op">:</span>mesh.nx<span class="op">÷</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span>;mesh.nx<span class="op">÷</span><span class="fl">2</span><span class="op">-</span>mesh.nx<span class="op">:-</span><span class="fl">1</span>]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    ky <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.ymax<span class="op">-</span>mesh.ymin)<span class="op">*</span>[<span class="fl">0</span><span class="op">:</span>mesh.ny<span class="op">÷</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span>;mesh.ny<span class="op">÷</span><span class="fl">2</span><span class="op">-</span>mesh.ny<span class="op">:-</span><span class="fl">1</span>]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    f  <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">ComplexF64</span>,(mesh.nx,mesh.ny))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    f <span class="op">.=</span> <span class="fu">compute_exact_solution</span>(<span class="fl">0.0</span>, mesh)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    f̂  <span class="op">=</span> <span class="fu">similar</span>(f)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    exky <span class="op">=</span> <span class="fu">exp</span>.( <span class="fl">1im</span><span class="fu">*tan</span>(dt<span class="op">/</span><span class="fl">2</span>) <span class="op">.*</span> mesh.x  <span class="op">.*</span> ky<span class="op">'</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    ekxy <span class="op">=</span> <span class="fu">exp</span>.(<span class="fu">-1im*sin</span>(dt)   <span class="op">.*</span> mesh.y<span class="op">'</span> <span class="op">.*</span> kx )</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    Px <span class="op">=</span> <span class="fu">plan_fft</span>(f, <span class="fl">1</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    Py <span class="op">=</span> <span class="fu">plan_fft</span>(f, <span class="fl">2</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>nsteps</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> Py <span class="op">*</span> f</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> f̂  <span class="op">.*</span> exky</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> Py <span class="op">\</span> f̂</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> Px <span class="op">*</span> f</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> f̂  <span class="op">.*</span> ekxy </span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> Px <span class="op">\</span> f̂</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> Py <span class="op">*</span> f</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> f̂  <span class="op">.*</span> exky</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>        f <span class="op">.=</span> Py <span class="op">\</span> f̂</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">real</span>(f)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>with_fft_plans (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>nsteps, final_time <span class="op">=</span> <span class="fl">1000</span>, <span class="fl">200</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> <span class="fu">with_fft_plans</span>(final_time, nsteps, mesh)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> <span class="fu">compute_exact_solution</span>(final_time, mesh)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>( <span class="st">" error = "</span>, <span class="fu">compute_error</span>(sol1, sol2))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">with_fft_plans</span>(final_time, nsteps, mesh);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> error = 1.8686623861233415e-13
  2.266 s (18030 allocations: 2.93 GiB)</code></pre>
</div>
</div>
</section>
</section>
<section id="inplace-computation-and-fft-plans" class="level2">
<h2 class="anchored" data-anchor-id="inplace-computation-and-fft-plans">Inplace computation and fft plans</h2>
<p>To apply fft plan to an array A, we use a preallocated output array Â by calling <code>mul!(Â, plan, A)</code>. The input array A must be a complex floating-point array like the output Â. The inverse-transform is computed inplace by applying <code>inv(P)</code> with <code>ldiv!(A, P, Â)</code>.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">with_fft_plans_inplace</span>(final_time, nsteps, mesh<span class="op">::</span><span class="dt">TwoDMesh</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> final_time<span class="op">/</span>nsteps</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    kx <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.xmax<span class="op">-</span>mesh.xmin) <span class="op">.*</span> <span class="fu">fftfreq</span>(mesh.nx, mesh.nx)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    ky <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.ymax<span class="op">-</span>mesh.ymin) <span class="op">.*</span> <span class="fu">fftfreq</span>(mesh.ny, mesh.ny)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    f  <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">ComplexF64</span>,(mesh.nx,mesh.ny))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    f <span class="op">.=</span> <span class="fu">compute_exact_solution</span>(<span class="fl">0.0</span>, mesh)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    f̂  <span class="op">=</span> <span class="fu">similar</span>(f)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    exky <span class="op">=</span> <span class="fu">exp</span>.( <span class="fl">1im</span><span class="fu">*tan</span>(dt<span class="op">/</span><span class="fl">2</span>) <span class="op">.*</span> mesh.x  <span class="op">.*</span> ky<span class="op">'</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    ekxy <span class="op">=</span> <span class="fu">exp</span>.(<span class="fu">-1im*sin</span>(dt)   <span class="op">.*</span> mesh.y<span class="op">'</span> <span class="op">.*</span> kx )</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    Px <span class="op">=</span> <span class="fu">plan_fft</span>(f, <span class="fl">1</span>)    </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    Py <span class="op">=</span> <span class="fu">plan_fft</span>(f, <span class="fl">2</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>nsteps</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mul!</span>(f̂, Py, f)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> f̂ <span class="op">.*</span> exky</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ldiv!</span>(f, Py, f̂)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mul!</span>(f̂, Px, f)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> f̂ <span class="op">.*</span> ekxy </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ldiv!</span>(f, Px, f̂)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mul!</span>(f̂, Py, f)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> f̂ <span class="op">.*</span> exky</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ldiv!</span>(f, Py, f̂)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">real</span>(f)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>with_fft_plans_inplace (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>nsteps, final_time <span class="op">=</span> <span class="fl">1000</span>, <span class="fl">200</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> <span class="fu">with_fft_plans_inplace</span>(final_time, nsteps, mesh)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> <span class="fu">compute_exact_solution</span>(final_time, mesh)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>( <span class="st">" error = "</span>, <span class="fu">compute_error</span>(sol1, sol2 ))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">with_fft_plans_inplace</span>(final_time, nsteps, mesh);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> error = 1.8686623861233415e-13
  1.696 s (6026 allocations: 3.82 MiB)</code></pre>
</div>
</div>
</section>
<section id="explicit-transpose-of-f" class="level2">
<h2 class="anchored" data-anchor-id="explicit-transpose-of-f">Explicit transpose of <code>f</code></h2>
<ul>
<li>Multidimensional arrays in Julia are stored in column-major order.</li>
<li>FFTs along y are slower than FFTs along x</li>
<li>We can speed-up the computation by allocating the transposed <code>f</code> and transpose f for each advection along y.</li>
</ul>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">with_fft_transposed</span>(final_time, nsteps, mesh<span class="op">::</span><span class="dt">TwoDMesh</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> final_time<span class="op">/</span>nsteps</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    kx <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.xmax<span class="op">-</span>mesh.xmin) <span class="op">.*</span> <span class="fu">fftfreq</span>(mesh.nx, mesh.nx)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    ky <span class="op">=</span> <span class="fl">2</span>π<span class="op">/</span>(mesh.ymax<span class="op">-</span>mesh.ymin) <span class="op">.*</span> <span class="fu">fftfreq</span>(mesh.ny, mesh.ny)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    f  <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">ComplexF64</span>,(mesh.nx,mesh.ny))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    f̂  <span class="op">=</span> <span class="fu">similar</span>(f)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    fᵗ <span class="op">=</span> <span class="fu">zeros</span>(<span class="dt">ComplexF64</span>,(mesh.ny,mesh.nx))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    f̂ᵗ <span class="op">=</span> <span class="fu">similar</span>(fᵗ)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    exky <span class="op">=</span> <span class="fu">exp</span>.( <span class="fl">1im</span><span class="fu">*tan</span>(dt<span class="op">/</span><span class="fl">2</span>) <span class="op">.*</span> mesh.x<span class="op">'</span> <span class="op">.*</span> ky )</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    ekxy <span class="op">=</span> <span class="fu">exp</span>.(<span class="fu">-1im*sin</span>(dt)   <span class="op">.*</span> mesh.y<span class="op">'</span> <span class="op">.*</span> kx )</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    FFTW.<span class="fu">set_num_threads</span>(<span class="fl">4</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    Px <span class="op">=</span> <span class="fu">plan_fft</span>(f,  <span class="fl">1</span>, flags<span class="op">=</span>FFTW.PATIENT)    </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    Py <span class="op">=</span> <span class="fu">plan_fft</span>(fᵗ, <span class="fl">1</span>, flags<span class="op">=</span>FFTW.PATIENT)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    f <span class="op">.=</span> <span class="fu">compute_exact_solution</span>(<span class="fl">0.0</span>, mesh)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>nsteps</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">transpose!</span>(fᵗ,f)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mul!</span>(f̂ᵗ, Py, fᵗ)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>        f̂ᵗ <span class="op">.=</span> f̂ᵗ <span class="op">.*</span> exky</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ldiv!</span>(fᵗ, Py, f̂ᵗ)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">transpose!</span>(f,fᵗ)</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mul!</span>(f̂, Px, f)</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>        f̂ <span class="op">.=</span> f̂ <span class="op">.*</span> ekxy </span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ldiv!</span>(f, Px, f̂)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">transpose!</span>(fᵗ,f)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mul!</span>(f̂ᵗ, Py, fᵗ)</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>        f̂ᵗ <span class="op">.=</span> f̂ᵗ <span class="op">.*</span> exky</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ldiv!</span>(fᵗ, Py, f̂ᵗ)</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">transpose!</span>(f,fᵗ)</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">real</span>(f)</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>with_fft_transposed (generic function with 1 method)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>nsteps, final_time <span class="op">=</span> <span class="fl">1000</span>, <span class="fl">200</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>sol1 <span class="op">=</span> <span class="fu">with_fft_transposed</span>(final_time, nsteps, mesh)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> <span class="fu">compute_exact_solution</span>(final_time, mesh)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>( <span class="st">" error = "</span>, <span class="fu">compute_error</span>(sol1, sol2))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@btime</span> <span class="fu">with_fft_transposed</span>(final_time, nsteps, mesh);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> error = 1.8528178494398663e-13
  654.487 ms (6038 allocations: 6.82 MiB)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>final_time, nsteps <span class="op">=</span> <span class="fl">400</span>π, <span class="fl">1000</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mesh <span class="op">=</span> <span class="fu">TwoDMesh</span>(<span class="op">-</span><span class="cn">π</span>, <span class="cn">π</span>, <span class="fl">512</span>, <span class="op">-</span><span class="cn">π</span>, <span class="cn">π</span>, <span class="fl">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>TwoDMesh(512, 256, -3.141592653589793, 3.141592653589793, -3.141592653589793, 3.141592653589793, 0.01227184630308513, 0.02454369260617026, [-3.141592653589793, -3.129320807286708, -3.1170489609836225, -3.104777114680538, -3.0925052683774528, -3.0802334220743677, -3.067961575771282, -3.055689729468197, -3.0434178831651124, -3.0311460368620273  …  3.018874190558941, 3.031146036862027, 3.0434178831651115, 3.0556897294681966, 3.0679615757712817, 3.0802334220743672, 3.092505268377452, 3.104777114680537, 3.117048960983622, 3.1293208072867076], [-3.141592653589793, -3.117048960983623, -3.0925052683774528, -3.0679615757712826, -3.0434178831651124, -3.0188741905589414, -2.994330497952771, -2.969786805346601, -2.945243112740431, -2.9206994201342606  …  2.8961557275280905, 2.9206994201342606, 2.945243112740431, 2.969786805346601, 2.994330497952771, 3.0188741905589414, 3.0434178831651124, 3.0679615757712826, 3.0925052683774528, 3.117048960983623])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>inplace_bench <span class="op">=</span> <span class="pp">@benchmark</span> <span class="fu">inplace</span>(final_time, nsteps, mesh)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>vectorized_bench <span class="op">=</span> <span class="pp">@benchmark</span> <span class="fu">vectorized</span>(final_time, nsteps, mesh)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>with_fft_plans_bench <span class="op">=</span> <span class="pp">@benchmark</span> <span class="fu">with_fft_plans</span>(final_time, nsteps, mesh)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>with_fft_plans_inplace_bench <span class="op">=</span> <span class="pp">@benchmark</span> <span class="fu">with_fft_plans_inplace</span>(final_time, nsteps, mesh)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>with_fft_transposed_bench <span class="op">=</span> <span class="pp">@benchmark</span> <span class="fu">with_fft_transposed</span>(final_time, nsteps, mesh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 3 samples with 1 evaluation.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">2.488 s</span> … <span class="ansi-magenta-fg">  2.517 s</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">2.503 s              </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">2.503 s</span> ± <span class="ansi-green-fg">14.494 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>0.01% ± 0.02%
  <span class="ansi-blue-fg">█</span>                            <span class="ansi-green-fg"> </span>█                         █  
  <span class="ansi-blue-fg">█</span>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁<span class="ansi-green-fg">▁</span>█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█ ▁
  2.49 s<span class="ansi-bright-black-fg">         Histogram: frequency by time</span>        2.52 s <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">26.32 MiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">6038</span>.</pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> <span class="fu">Dict</span>() </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>d[<span class="st">"vectorized"</span>] <span class="op">=</span> <span class="fu">minimum</span>(vectorized_bench.times) <span class="op">/</span> <span class="fl">1e6</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>d[<span class="st">"inplace"</span>] <span class="op">=</span> <span class="fu">minimum</span>(inplace_bench.times) <span class="op">/</span> <span class="fl">1e6</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>d[<span class="st">"with_fft_plans"</span>] <span class="op">=</span> <span class="fu">minimum</span>(with_fft_plans_bench.times) <span class="op">/</span> <span class="fl">1e6</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>d[<span class="st">"with_fft_plans_inplace"</span>] <span class="op">=</span> <span class="fu">minimum</span>(with_fft_plans_inplace_bench.times) <span class="op">/</span> <span class="fl">1e6</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>d[<span class="st">"with_fft_transposed"</span>] <span class="op">=</span> <span class="fu">minimum</span>(with_fft_transposed_bench.times) <span class="op">/</span> <span class="fl">1e6</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (key, value) <span class="kw">in</span> <span class="fu">sort</span>(<span class="fu">collect</span>(d), by<span class="op">=</span>last)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="fu">rpad</span>(key, <span class="fl">25</span>, <span class="st">"."</span>), <span class="fu">lpad</span>(<span class="fu">round</span>(value, digits<span class="op">=</span><span class="fl">1</span>), <span class="fl">6</span>, <span class="st">"."</span>))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>with_fft_transposed......2487.8
inplace..................4098.0
with_fft_plans_inplace...4436.5
vectorized...............6520.1
with_fft_plans...........6604.4</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>Using pre-allocations of memory and inplace computation is very important</li>
<li>Try to always do computation on data contiguous in memory</li>
<li>Use <code>plans</code> for fft</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../diffeq/poisson-equation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Poisson Equation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../diffeq/gpu.html" class="pagination-link">
        <span class="nav-page-text">GPU</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>