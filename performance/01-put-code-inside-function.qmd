---
title: 'Performance critical code should be inside a function'
---

Let's compute $y = a * x$
```{julia}
n = 100_000
a = 1.2
x = rand(Float64, n)
y = rand(Float64, n)

@time for i in eachindex(y, x)
    y[i] += a * x[i]
end
```

---

To optimize the code, Julia needs it to be inside a function.
```{julia}

function axpy!(y, a, x)
    for i in eachindex(y, x)
        y[i] += a * x[i]
    end
end

# warmup
axpy!(y, a, x)

# timing
@time axpy!(y, a, x)
```

